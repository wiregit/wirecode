package com.limegroup.gnutella.malware;

import org.limewire.core.api.malware.VirusEngine;
import org.limewire.inject.AbstractModule;
import org.limewire.inject.LazyBinder;
import org.limewire.util.OSUtils;

public class LimeWireMalwareModule extends AbstractModule {
    @Override
    protected void configure() {
        bind(DangerousFileChecker.class).toProvider(LazyBinder.newLazyProvider(
                DangerousFileChecker.class, FileExtensionChecker.class));
        if(OSUtils.isWindows()) {
            bind(VirusScanner.class).to(VirusScannerImpl.class);
        } else {
            bind(VirusScanner.class).to(NoOpVirusScanner.class);
        }
        bind(VirusDefinitionManager.class).to(VirusDefinitionManagerImpl.class);
        bind(VirusDefinitionDownloader.class).to(VirusDefinitionDownloaderImpl.class);
        bind(AntivirusSupportConfiguration.class).to(AntivirusSupportConfigurationImpl.class);
        bind(VirusEngine.class).to(VirusEngineImpl.class);
    }
}
