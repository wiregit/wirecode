package com.limegroup.gnutella.malware;

import org.limewire.core.api.malware.VirusEngine;
import org.limewire.inject.LazySingleton;

import com.google.inject.Inject;

@LazySingleton
public class VirusEngineImpl implements VirusEngine {

    private final VirusScanner virusScanner;
    private VirusDefinitionManager virusDefinitionManager;

    @Inject
    public VirusEngineImpl(VirusScanner virusScanner, VirusDefinitionManager virusDefinitionManager) {
        this.virusScanner = virusScanner;
        this.virusDefinitionManager = virusDefinitionManager;
    }

    @Override
    public boolean isSupported() {
        return virusScanner.isSupported();
    }

    @Override
    public void checkForUpdates() {
        virusDefinitionManager.checkForDefinitions();        
    }
}
