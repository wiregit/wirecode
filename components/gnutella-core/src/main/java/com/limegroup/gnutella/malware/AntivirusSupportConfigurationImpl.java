package com.limegroup.gnutella.malware;

import org.limewire.activation.api.ActivationID;
import org.limewire.activation.api.ActivationManager;
import org.limewire.core.settings.MalwareSettings;
import org.limewire.util.OSUtils;

import com.google.inject.Inject;
import com.limegroup.gnutella.util.LimeWireUtils;

/**
 *Delegate for the settings used by VirusScannerImpl to determine whether or
 * not antivirus is supported and enabled.
 * 
 * THIS SHOULD NOT BE USED EXCEPT BY VirusScannerImpl AND ITS TESTS.
 */
class AntivirusSupportConfigurationImpl implements AntivirusSupportConfiguration {

    private final ActivationManager activationManager;
    
    @Inject
    public AntivirusSupportConfigurationImpl(ActivationManager activationManager) {
        this.activationManager = activationManager;
    }
    
    @Override
    public boolean isAVGCompatibleWindows() {
        return OSUtils.isAVGCompatibleWindows();
    }

    @Override
    public boolean isAVGModuleActivated() {
        return activationManager.isActive(ActivationID.AVG_MODULE);
    }

    @Override
    public boolean isTemporaryDirectoryInUse() {
        return LimeWireUtils.isTemporaryDirectoryInUse();
    }
    
    @Override
    public boolean isVirusScannerEnabledInSettings() {
        return MalwareSettings.VIRUS_SCANNER_ENABLED.getValue();
    }
}