package com.limegroup.gnutella.malware;

import java.io.File;
import java.net.URI;
import java.util.HashMap;
import java.util.Map;

import org.limewire.util.GenericsUtils;
import org.limewire.util.GenericsUtils.ScanMode;

import com.limegroup.gnutella.downloader.DownloaderType;
import com.limegroup.gnutella.downloader.serial.DownloadMemento;

public class VirusDefinitionDownloadMemento implements DownloadMemento {

    private final Map<String, Object> serialObjects;

    public VirusDefinitionDownloadMemento(URI uri) {
        serialObjects = new HashMap<String, Object>();
        serialObjects.put("uri", uri);
    }

    @Override
    public Map<String, Object> getAttributes() {
        return GenericsUtils.scanForMap(serialObjects.get("attributes"),
                String.class, Object.class, ScanMode.REMOVE);
    }

    @Override
    public void setAttributes(Map<String, Object> attributes) {
        serialObjects.put("attributes", attributes);
    }

    @Override
    public String getDefaultFileName() {
        return getSaveFile().getName();
    }

    @Override
    public void setDefaultFileName(String defaultFileName) {
        serialObjects.put("defaultFileName", defaultFileName);
    }

    @Override
    public DownloaderType getDownloadType() {
        return DownloaderType.ANTIVIRUS;
    }

    @Override
    public void setDownloadType(DownloaderType downloaderType) {
        // Always DownloaderType.ANTIVIRUS
    }

    @Override
    public File getSaveFile() {
        return (File)serialObjects.get("saveFile");
    }

    @Override
    public void setSaveFile(File saveFile) {
        serialObjects.put("saveFile", saveFile);
    }
    
    public URI getURI() {
        return (URI)serialObjects.get("uri");
    }
}
