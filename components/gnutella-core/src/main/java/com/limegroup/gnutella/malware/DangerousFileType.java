package com.limegroup.gnutella.malware;

class DangerousFileType {

    // The mime type of ASF files, as detected by older LimeWire versions
    private static final String ASF_OLD_TYPE = "video/x-ms-asf";

    // No extensions are permitted for video/x-ms-asf, in order to protect
    // older LimeWire versions from dangerous ASF files
    private static final String[] ASF_OLD_EXTENSIONS = new String[0];

    // The mime type of ASF files, as detected by newer LimeWire versions
    private static final String ASF_NEW_TYPE = "video/x-lime-asf";

    // Known file extensions for ASF files
    private static final String[] ASF_NEW_EXTENSIONS = {
        "asf", "asx", "wax", "wm", "wma", "wmv", "wmx", "wvx"
    };

    // The mime type of EXE files
    private static final String EXE_TYPE = "application/x-dosexec";

    // Known file extensions of EXE files
    private static final String[] EXE_EXTENSIONS = {
        // I've found and tested examples of the following extensions
        "acm", "ax", "com", "cpl", "dll", "drv", "exe", "fon", "ocx", "scr", "sys",
        // I haven't found examples of the following extensions, but see
        // http://www.garykessler.net/library/file_sigs.html
        "386", "pif", "qts", "qtx", "vbx", "vxd"
    };

    // A mime type for various malware files
    private static final String MAL_TYPE = "application/x-mal";

    // No file extensions are permitted for malware files
    private static final String[] MAL_EXTENSIONS = new String[0];

    final String mimeType;
    final String[] extensions;

    DangerousFileType(String mimeType, String[] extensions) {
        this.mimeType = mimeType;
        this.extensions = extensions;
    }

    /**
     * Returns an array of known file types, which may be empty but not null.
     */
    protected static DangerousFileType[] getKnownTypes() {
        return new DangerousFileType[] {
                // Add known file types here
                new DangerousFileType(ASF_OLD_TYPE, ASF_OLD_EXTENSIONS),
                new DangerousFileType(ASF_NEW_TYPE, ASF_NEW_EXTENSIONS),
                new DangerousFileType(EXE_TYPE, EXE_EXTENSIONS),
                new DangerousFileType(MAL_TYPE, MAL_EXTENSIONS)
        };
    }
}
