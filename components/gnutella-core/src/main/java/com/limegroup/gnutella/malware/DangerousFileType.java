package com.limegroup.gnutella.malware;

class DangerousFileType {
    
    // The sixteen magic bytes at the start of every ASF file - see
    // http://www.microsoft.com/windows/windowsmedia/forpros/format/asfspec.aspx
    private static final byte[] ASF_MAGIC = {
        (byte)0x30, (byte)0x26, (byte)0xB2, (byte)0x75,
        (byte)0x8E, (byte)0x66, (byte)0xCF, (byte)0x11,
        (byte)0xA6, (byte)0xD9, (byte)0x00, (byte)0xAA,
        (byte)0x00, (byte)0x62, (byte)0xCE, (byte)0x6C
    };

    // Known file extensions for ASF files
    private static final String[] ASF_EXTENSIONS = {
        "asf", "wm", "wma", "wmv"
    };

    final byte[] magic;
    final String[] extensions;

    DangerousFileType(byte[] magic, String[] extensions) {
        this.magic = magic;
        this.extensions = extensions;
    }
    
    /**
     * Returns an array of known file types, which may be empty but not null.
     */
    protected static DangerousFileType[] getKnownTypes() {
        return new DangerousFileType[] {
                // Add known file types here
                new DangerousFileType(ASF_MAGIC, ASF_EXTENSIONS)
        };
    }
}
